<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jezzel Faith Gier — Deep Learning Portfolio</title>
  <meta name="description" content="Deep Learning portfolio for Jezzel Faith Gier, powered by a live GitHub repository." />
  <style>
    :root{
      --accent:#b0152a;
      --accent-soft:#fef2f2;
      --accent-soft-border:#fecaca;
      --sidebar-bg:#020617;
      --sidebar-border:#111827;
      --text:#0f172a;
      --muted:#6b7280;
      --card:#ffffff;
      --page-bg:#f3f4f6;
      --pill-bg:#e5e7eb;
      --shadow-soft:0 18px 45px rgba(15,23,42,.18);
    }
    body.theme-dark{
      --page-bg:#020617;
      --card:#020617;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --sidebar-bg:#000000;
      --sidebar-border:#111827;
      --pill-bg:#0f172a;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;
      padding:0;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
    }
    body{
      background:radial-gradient(circle at top left,#fee2e2 0,#f3f4f6 40%,#e5e7eb 100%);
      color:var(--text);
      line-height:1.7;
      transition:background .2s ease,color .2s ease;
    }
    body.theme-dark{
      background:#020617;
    }

    /* TOP BAR */
    .topbar{
      background:#005f4f;
      color:#f9fafb;
      box-shadow:0 2px 4px rgba(15,23,42,.35);
      position:sticky;
      top:0;
      z-index:30;
    }
    .topbar-inner{
      max-width:1320px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:6px 16px;
      font-size:14px;
    }
    .topbar-left{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .topbar-title{
      font-weight:500;
      letter-spacing:.06em;
      text-transform:uppercase;
      font-size:12px;
      opacity:.9;
    }
    .icon-button{
      background:none;
      border:none;
      color:inherit;
      cursor:pointer;
      padding:4px 6px;
      border-radius:6px;
      font-size:16px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .icon-button:hover{
      background:rgba(15,23,42,.25);
    }
    .topbar-actions{
      display:flex;
      align-items:center;
      gap:4px;
    }

    .layout{
      display:grid;
      grid-template-columns:260px minmax(0,1fr) 230px;
      min-height:100vh;
      max-width:1320px;
      margin:0 auto;
    }

    body.sidebar-hidden .sidebar{display:none;}
    body.sidebar-hidden .layout{grid-template-columns:minmax(0,1fr) 230px;}
    body.toc-hidden .toc{display:none;}
    body.toc-hidden .layout{grid-template-columns:260px minmax(0,1fr);}
    body.sidebar-hidden.toc-hidden .layout{grid-template-columns:minmax(0,1fr);}

    /* LEFT SIDEBAR */
    .sidebar{
      background:var(--sidebar-bg);
      color:#e5e7eb;
      border-right:1px solid var(--sidebar-border);
      padding:22px 20px 26px;
      display:flex;
      flex-direction:column;
      gap:18px;
      position:sticky;
      top:38px;
      height:calc(100vh - 38px);
      overflow:auto;
    }
    .sidebar-logo{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      gap:8px;
    }
    .sidebar-logo img{
      width:64px;
      height:64px;
      object-fit:cover;
      border-radius:50%;
      background:#fef2f2;
      padding:4px;
      box-shadow:0 8px 22px rgba(0,0,0,.45);
    }
    .sidebar-title{
      font-size:14px;
      font-weight:700;
      letter-spacing:.08em;
      text-transform:uppercase;
    }
    .sidebar-subtitle{
      font-size:13px;
      color:#9ca3af;
      margin-top:2px;
    }
    .sidebar-section-title{
      margin:14px 0 6px;
      font-size:12px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:#9ca3af;
    }
    .sidebar-nav{
      list-style:none;
      padding:0;
      margin:0;
      font-size:14px;
    }
    .sidebar-nav li{margin:3px 0}
    .sidebar-nav a{
      color:#e5e7eb;
      text-decoration:none;
      padding:4px 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .sidebar-nav a span{
      font-size:11px;
      padding:1px 6px;
      border-radius:999px;
      background:rgba(249,250,251,.08);
      border:1px solid rgba(148,163,184,.3);
      color:#9ca3af;
    }
    .sidebar-nav a:hover{
      color:#ffffff;
      text-decoration:underline;
    }

    /* Sidebar search */
    .sidebar-search{margin-top:8px;}
    .sidebar-search input{
      width:100%;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:#020617;
      color:#e5e7eb;
      font-size:13px;
      outline:none;
    }
    .sidebar-search input::placeholder{color:#6b7280;}
    .sidebar-search-results{
      margin-top:8px;
      font-size:13px;
      max-height:180px;
      overflow:auto;
    }
    .sidebar-search-item{
      width:100%;
      text-align:left;
      background:none;
      border:none;
      padding:4px 4px;
      margin-bottom:2px;
      border-radius:6px;
      color:#e5e7eb;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
    }
    .sidebar-search-item:hover{
      background:rgba(148,163,184,.25);
    }
    .sidebar-search-kind{
      font-size:10px;
      padding:1px 6px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.7);
      color:#d1d5db;
      white-space:nowrap;
    }
    .sidebar-search-empty{
      color:#9ca3af;
      font-size:12px;
    }

    /* MAIN CONTENT */
    main{padding:24px 32px 42px;}
    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:2px 10px 3px;
      border-radius:999px;
      font-size:11px;
      background:var(--pill-bg);
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.14em;
    }
    .pill-dot{
      width:7px;height:7px;border-radius:999px;background:var(--accent);
    }
    h1{
      font-size:32px;
      margin:10px 0 4px;
      letter-spacing:.01em;
    }
    .lead{
      margin-top:6px;
      color:var(--muted);
      max-width:720px;
      font-size:14px;
    }
    .hero-meta{
      display:flex;flex-wrap:wrap;gap:10px;margin-top:14px;
      font-size:12px;color:var(--muted);
    }
    .hero-meta span{
      padding:3px 10px;border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      background:rgba(255,255,255,.6);
      backdrop-filter:blur(6px);
    }

    .section{margin-top:30px;}
    .section-header{
      display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;
    }
    .section h2{font-size:20px;margin:0;}
    .section-tag{
      font-size:11px;text-transform:uppercase;letter-spacing:.18em;color:var(--muted);
    }
    .section-divider{
      width:42px;height:3px;border-radius:999px;
      background:linear-gradient(90deg,var(--accent),#fb7185);
      margin-top:4px;
    }
    .section p{margin:6px 0 0;font-size:14px;}

    .card{
      background:var(--card);
      border-radius:18px;
      padding:18px 18px 20px;
      box-shadow:var(--shadow-soft);
      border:1px solid rgba(148,163,184,.4);
    }

    /* Live repo viewer layout – preview dominates */
    .repo-layout{
      display:grid;
      grid-template-columns:minmax(0,0.85fr) minmax(0,1.6fr);
      gap:18px;
      align-items:flex-start;
      margin-top:14px;
    }

    .meta{font-size:12px;color:var(--muted);}
    .small{font-size:13px;color:var(--muted);}
    .meta-highlight{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;
      background:var(--accent-soft);
      border:1px solid var(--accent-soft-border);
      color:#991b1b;font-size:11px;margin-top:8px;
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(210px,1fr));
      gap:12px;
      margin-top:10px;
    }
    .folder-card{
      border-radius:14px;
      padding:10px 11px 11px;
      background:linear-gradient(135deg,#ffffff,#f9fafb);
      border:1px solid rgba(209,213,219,.9);
      box-shadow:0 10px 28px rgba(15,23,42,.12);
      cursor:pointer;
      transition:transform .1s ease,box-shadow .1s ease,border-color .1s ease;
    }
    .folder-card:hover{
      transform:translateY(-1px);
      box-shadow:0 14px 38px rgba(15,23,42,.18);
      border-color:#fecaca;
    }
    .folder-title{
      font-weight:600;margin-bottom:4px;
      display:flex;align-items:center;gap:6px;
    }
    .folder-badge{
      font-size:11px;padding:1px 7px;border-radius:999px;
      color:#7f1d1d;background:#fee2e2;border:1px solid #fecaca;
    }
    .folder-path{font-size:11px;color:var(--muted);}

    .btn{
      display:inline-flex;align-items:center;gap:6px;
      margin-top:12px;padding:8px 13px;border-radius:999px;
      background:var(--accent);color:white;font-size:13px;
      text-decoration:none;border:none;cursor:pointer;
      box-shadow:0 10px 26px rgba(190,24,93,.55);
    }
    .btn:hover{opacity:.94;}

    pre{
      white-space:pre-wrap;background:#020617;color:#e5e7eb;
      padding:10px;border-radius:8px;font-size:12px;overflow:auto;
    }

    .link-list{
      list-style:none;padding:0;margin:10px 0 0;font-size:14px;
    }
    .link-list li{
      margin:3px 0;
      display:flex;align-items:center;justify-content:space-between;gap:8px;
    }

    .link-button{
      background:none;border:none;padding:0;margin:0;
      color:#1d4ed8;cursor:pointer;font-size:14px;
      text-align:left;font-family:inherit;
    }
    .link-button:hover{text-decoration:underline;}

    .chip{
      font-size:11px;padding:1px 7px;border-radius:999px;
      border:1px solid rgba(148,163,184,.6);color:var(--muted);white-space:nowrap;
    }
    .chip-lecture{border-color:#bfdbfe;color:#1d4ed8;background:#eff6ff;}
    .chip-lab{border-color:#bbf7d0;color:#15803d;background:#ecfdf3;}
    .chip-ex{border-color:#fde68a;color:#92400e;background:#fffbeb;}
    .chip-group{border-color:#e5e7eb;color:#374151;background:#f9fafb;}
    .chip-blog{border-color:#fecaca;color:#b91c1c;background:#fef2f2;}

    /* Preview panel */
    .preview-header{
      display:flex;align-items:center;justify-content:space-between;
      margin-bottom:8px;gap:8px;
    }
    .preview-title{
      font-size:14px;font-weight:600;color:#0f172a;
      display:flex;align-items:center;gap:8px;
    }
    .preview-title span{
      display:inline-flex;align-items:center;justify-content:center;
      width:22px;height:22px;border-radius:999px;
      background:#fee2e2;color:#b91c1c;font-size:12px;font-weight:700;
    }
    .preview-sub{font-size:11px;color:var(--muted);}
    .preview-body{
      border-radius:12px;border:1px solid rgba(209,213,219,.9);
      background:#f9fafb;padding:10px 12px;
      max-height:700px;
      min-height:450px;
      overflow:auto;
    }
    .preview-body iframe{
      width:100%;height:640px;border:none;border-radius:8px;background:white;
    }

    footer{
      margin-top:32px;font-size:12px;color:var(--muted);
    }

    /* RIGHT CONTENTS COLUMN */
    .toc{
      border-left:1px solid rgba(209,213,219,.9);
      padding:26px 18px 28px;
      font-size:13px;
      background:linear-gradient(to bottom,#f9fafb,#f3f4f6);
      position:sticky;
      top:38px;
      height:calc(100vh - 38px);
      overflow:auto;
    }
    .toc h3{
      margin-top:0;font-size:13px;
      text-transform:uppercase;letter-spacing:.16em;color:var(--muted);
    }
    .toc ul{
      list-style:none;padding-left:0;margin:8px 0 0;
    }
    .toc li{margin:3px 0;}
    .toc a{
      color:#111827;text-decoration:none;font-size:13px;
    }
    .toc a:hover{text-decoration:underline;}

    @media (max-width:1160px){
      .layout{grid-template-columns:230px minmax(0,1fr);}
      .toc{display:none;}
    }
    @media (max-width:800px){
      .layout{grid-template-columns:1fr;max-width:100%;}
      .sidebar{
        position:relative;top:0;height:auto;
        flex-direction:column;align-items:stretch;gap:16px;
      }
      main{padding:20px 18px 26px;}
      .repo-layout{grid-template-columns:1fr;}
      .preview-body{max-height:none;height:auto;}
      .preview-body iframe{height:520px;}
    }
  </style>
</head>
<body>
<header class="topbar">
  <div class="topbar-inner">
    <div class="topbar-left">
      <button class="icon-button" onclick="toggleSidebar()" title="Toggle navigation">☰</button>
      <div class="topbar-title">JFG Deep Learning Portfolio</div>
    </div>
    <div class="topbar-actions">
      <button class="icon-button" onclick="downloadZip()" title="Download repo ZIP">⭳</button>
      <button class="icon-button" onclick="toggleFullscreen()" title="Toggle fullscreen">⛶</button>
      <button class="icon-button" onclick="toggleTheme()" title="Toggle light/dark theme">☾</button>
      <button class="icon-button" onclick="toggleToc()" title="Toggle contents panel">☷</button>
    </div>
  </div>
</header>

<div class="layout">
  <!-- LEFT SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <img src="https://raw.githubusercontent.com/Jzelfthr/DEEP_LEARNING/main/logo.png"
           alt="JFG Deep Learning Portfolio Logo"
           onerror="this.src='logo.png'">
      <div>
        <div class="sidebar-title">JFG Portfolio</div>
        <div class="sidebar-subtitle">Deep Learning · Academic Work</div>
      </div>
    </div>

    <div class="sidebar-search">
      <input type="search" id="sidebar-search" placeholder="Search HTML pages…" oninput="handleSearch(this.value)">
      <div id="search-results" class="sidebar-search-results"></div>
    </div>

    <div class="sidebar-sections">
      <div class="sidebar-section-title">Sections</div>
      <ul class="sidebar-nav">
        <li><a href="#top">Overview <span>intro</span></a></li>
        <li><a href="#repo-viewer">Main viewer <span>screen</span></a></li>
      </ul>

      <div class="sidebar-section-title">Lectures (HTML)</div>
      <ul class="sidebar-nav" id="sidebar-lectures">
        <li class="small" style="color:#9ca3af;">Loading…</li>
      </ul>

      <div class="sidebar-section-title">Labs (HTML)</div>
      <ul class="sidebar-nav" id="sidebar-labs">
        <li class="small" style="color:#9ca3af;">Loading…</li>
      </ul>

      <div class="sidebar-section-title">Exercises (HTML)</div>
      <ul class="sidebar-nav" id="sidebar-exercises">
        <li class="small" style="color:#9ca3af;">Loading…</li>
      </ul>

      <div class="sidebar-section-title">Group work (HTML)</div>
      <ul class="sidebar-nav" id="sidebar-groups">
        <li class="small" style="color:#9ca3af;">Loading…</li>
      </ul>

      <div class="sidebar-section-title">Blog (HTML)</div>
      <ul class="sidebar-nav" id="sidebar-blog">
        <li class="small" style="color:#9ca3af;">Loading…</li>
      </ul>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main id="top">
    <div class="pill"><span class="pill-dot"></span> Deep Learning Portfolio</div>
    <h1>The Deep Learning Portfolio of Jezzel Faith Gier</h1>
    <p class="lead">
      This site presents my work in deep learning as a structured, browsable portfolio.
      All content is pulled live from the
      <code>DEEP_LEARNING</code> repository and rendered inside this page.
    </p>
    <div class="hero-meta">
      <span>Lectures · Labs · Exercises · Group Activities · Blog</span>
      <span>HTML pages only — exported views</span>
    </div>

    <section id="what-you-will-find" class="section">
      <div class="section-header">
        <div>
          <h2>What you will find</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">Overview</div>
      </div>
      <p class="small">
        This portfolio focuses on the HTML exports of my work. When you click any lab, lecture,
        exercise, group activity, or blog entry (from the sidebar or from the lists), the big
        viewer below becomes that page.
      </p>
    </section>

    <section id="repo-viewer" class="section">
      <div class="section-header">
        <div>
          <h2>Live repo viewer</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">Main screen</div>
      </div>
      <div class="repo-layout">
        <div class="card">
          <p class="small">
            This viewer uses the GitHub API to list folders and files from the
            <code>DEEP_LEARNING</code> repository. Whenever you select an HTML file (lab, lecture,
            exercise, group work, or blog post), it opens in the large panel on the right.
          </p>

          <div class="meta-highlight">
            <span>●</span>
            <span id="repo-info">Loading repository information…</span>
          </div>

          <div class="section" style="margin-top:16px;">
            <h3 style="font-size:15px;margin:0 0 4px;">Top-level folders</h3>
            <p class="small" style="margin-top:2px;">Click a folder to auto-pick a main HTML page if available.</p>
            <div id="folders" class="grid"></div>
          </div>
        </div>

        <div class="card">
          <div class="preview-header">
            <div class="preview-title">
              <span>JP</span>
              <div>
                <div id="preview-label">Portfolio preview</div>
                <div class="preview-sub" id="preview-path">Select any HTML page to load it here.</div>
              </div>
            </div>
          </div>
          <div class="preview-body" id="preview-body">
            <div id="preview" class="small">
              Select a folder, lab, lecture, exercise, group activity, or blog post (HTML)
              to display it here as the main page.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Middle lists (mirror of sidebar, still clickable) -->
    <section id="lectures-section" class="section">
      <div class="section-header">
        <div>
          <h2>Lectures</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">HTML pages</div>
      </div>
      <p class="small">HTML lecture pages from the <code>lectures/</code> folder.</p>
      <div class="card">
        <ul id="lectures-list" class="link-list">
          <li class="small">Loading lectures…</li>
        </ul>
      </div>
    </section>

    <section id="labs-section" class="section">
      <div class="section-header">
        <div>
          <h2>Labs</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">HTML pages</div>
      </div>
      <p class="small">HTML laboratory activities from the <code>labs/</code> folder.</p>
      <div class="card">
        <ul id="labs-list" class="link-list">
          <li class="small">Loading labs…</li>
        </ul>
      </div>
    </section>

    <section id="exercises-section" class="section">
      <div class="section-header">
        <div>
          <h2>Exercises</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">HTML pages</div>
      </div>
      <p class="small">HTML exercise pages from <code>exercises/</code>.</p>
      <div class="card">
        <ul id="ex-list" class="link-list">
          <li class="small">Loading exercises…</li>
        </ul>
      </div>
    </section>

    <section id="group-activities-section" class="section">
      <div class="section-header">
        <div>
          <h2>Group activities</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">HTML pages</div>
      </div>
      <p class="small">HTML group work pages from <code>group-activities/</code>.</p>
      <div class="card">
        <ul id="group-list" class="link-list">
          <li class="small">Loading group activities…</li>
        </ul>
      </div>
    </section>

    <section id="blog-section" class="section">
      <div class="section-header">
        <div>
          <h2>Blog posts</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">HTML pages</div>
      </div>
      <p class="small">HTML blog pages from the <code>Blog_Post/</code> folder.</p>
      <div class="card">
        <div id="blog-list" class="grid">
          <div class="small">Loading blog posts…</div>
        </div>
      </div>
    </section>

    <section id="about" class="section card">
      <div class="section-header" style="margin-bottom:10px;">
        <div>
          <h2>About this portfolio</h2>
          <div class="section-divider"></div>
        </div>
        <div class="section-tag">How it works</div>
      </div>
      <p class="small">
        This page is a single static HTML file that runs entirely in the browser. It uses the
        public GitHub API to fetch files from <code>Jzelfthr/DEEP_LEARNING</code>. Only HTML
        exports (for labs, lectures, exercises, group activities, and blog posts) are shown
        in the main viewer.
      </p>
      <p class="small">
        That means you can keep your source notebooks (<code>.ipynb</code>) in the repo, but
        the site will only surface their HTML versions to keep the experience clean and focused.
      </p>
    </section>

    <footer>
      Built for <strong>DEEP_LEARNING</strong> —
      <span id="last-updated">checking latest commit…</span>
    </footer>
  </main>

  <!-- RIGHT CONTENTS COLUMN -->
  <aside class="toc">
    <h3>Contents</h3>
    <ul id="toc-list"></ul>
  </aside>
</div>

<script>
  const owner = 'Jzelfthr';
  const repo  = 'DEEP_LEARNING';
  const apiBase = `https://api.github.com/repos/${owner}/${repo}/contents`;
  const searchIndex = [];

  function scrollToPreview(){
    const section = document.getElementById('repo-viewer');
    if(section){
      section.scrollIntoView({behavior:'smooth', block:'start'});
    }
  }

  async function fetchJson(url){
    const res = await fetch(url);
    if(!res.ok) throw new Error('HTTP ' + res.status);
    return res.json();
  }

  function buildToc(folders){
    const toc = document.getElementById('toc-list');
    toc.innerHTML = '';
    const sections = [
      {id:'what-you-will-find', label:'What you will find'},
      {id:'repo-viewer',        label:'Main viewer'},
      {id:'lectures-section',   label:'Lectures',          folder:'lectures'},
      {id:'labs-section',       label:'Labs',              folder:'labs'},
      {id:'exercises-section',  label:'Exercises',         folder:'exercises'},
      {id:'group-activities-section', label:'Group activities', folder:'group-activities'},
      {id:'blog-section',       label:'Blog posts',        folder:'Blog_Post'},
      {id:'about',              label:'About this portfolio'}
    ];
    sections.forEach(sec=>{
      if(sec.folder){
        const exists = folders.some(f => f.name === sec.folder);
        if(!exists) return;
      }
      const li = document.createElement('li');
      li.innerHTML = `<a href="#${sec.id}">${sec.label}</a>`;
      toc.appendChild(li);
    });
  }

  async function loadRepo(){
    try{
      const root = await fetchJson(apiBase);
      document.getElementById('repo-info').innerText =
        `${repo} — ${root.length} items at the top level.`;

      const folders = root.filter(f => f.type === 'dir');
      renderFolders(folders);
      buildToc(folders);

      if(folders.find(f => f.name === 'lectures')) loadFolderList('lectures','lectures-list', 'lecture');
      else {
        document.getElementById('lectures-list').innerHTML = '<li class="small">No lectures folder found.</li>';
        document.getElementById('sidebar-lectures').innerHTML = '<li class="small" style="color:#9ca3af;">No lectures</li>';
      }

      if(folders.find(f => f.name === 'labs')) loadFolderList('labs','labs-list', 'lab');
      else {
        document.getElementById('labs-list').innerHTML = '<li class="small">No labs folder found.</li>';
        document.getElementById('sidebar-labs').innerHTML = '<li class="small" style="color:#9ca3af;">No labs</li>';
      }

      if(folders.find(f => f.name === 'exercises')) loadFolderList('exercises','ex-list', 'exercise');
      else {
        document.getElementById('ex-list').innerHTML = '<li class="small">No exercises folder found.</li>';
        document.getElementById('sidebar-exercises').innerHTML = '<li class="small" style="color:#9ca3af;">No exercises</li>';
      }

      if(folders.find(f => f.name === 'group-activities')) loadFolderList('group-activities','group-list', 'group');
      else {
        document.getElementById('group-list').innerHTML = '<li class="small">No group-activities folder found.</li>';
        document.getElementById('sidebar-groups').innerHTML = '<li class="small" style="color:#9ca3af;">No group work</li>';
      }

      const commits = await fetchJson(`https://api.github.com/repos/${owner}/${repo}/commits?per_page=1`);
      document.getElementById('last-updated').innerText =
        `latest commit on ${new Date(commits[0].commit.author.date).toLocaleString()}`;
    }catch(e){
      document.getElementById('repo-info').innerText =
        'Could not load repository data: ' + e.message +
        ' (check that the repo is public and that the owner/repo names are correct).';
    }
  }

  function renderFolders(folders){
    const el = document.getElementById('folders');
    el.innerHTML = '';
    folders.forEach(f => {
      const div = document.createElement('div');
      div.className = 'folder-card';
      div.innerHTML = `
        <div class="folder-title">
          <span>${f.name}</span>
          <span class="folder-badge">folder</span>
        </div>
        <div class="folder-path">${f.path}</div>
        <div class="small" style="margin-top:4px;">Click to auto-open a main HTML page (if present).</div>`;
      div.onclick = () => openFolder(f.path);
      el.appendChild(div);
    });
  }

  async function openFolder(path){
    try{
      scrollToPreview();
      const list = await fetchJson(`${apiBase}/${path}`);
      const mainFile =
        list.find(x => /index\.html?/i.test(x.name)) ||
        list.find(x => /\.html?$/i.test(x.name)) ||
        null;

      document.getElementById('preview-label').textContent = path;
      document.getElementById('preview-path').textContent = 'Folder preview (HTML)';

      if(mainFile){
        await openFile(mainFile.path, mainFile.name, true);
      }else{
        const htmlList = '<ul>' + list.map(x =>
          `<li>${x.name} — ${x.type}</li>`
        ).join('') + '</ul>';
        showPreview(htmlList);
      }
    }catch(e){
      showPreview(`<p class="small">Could not open folder <code>${path}</code>: ${e.message}</p>`);
    }
  }

  async function openFile(path, label, fromFolder){
    try{
      scrollToPreview();
      const file = await fetchJson(`${apiBase}/${path}`);
      if(file.type !== 'file'){
        showPreview(`<p class="small">This is not a regular file.</p>`);
        return;
      }

      document.getElementById('preview-label').textContent = label || file.name;
      document.getElementById('preview-path').textContent = path;

      const lower = file.name.toLowerCase();
      const body = document.getElementById('preview-body');
      body.innerHTML = '<div id="preview" class="small">Loading…</div>';

      if(lower.endsWith('.md')){
        if(!file.download_url){
          showPreview(`<p class="small">No direct download URL for ${file.name}.</p>`);
          return;
        }
        const res = await fetch(file.download_url);
        const text = await res.text();
        const html = renderMarkdown(text);
        showPreview(html);
      }else if(lower.endsWith('.ipynb')){
        showPreview(
          `<p class="small"><code>${file.name}</code> is a Jupyter notebook (.ipynb). ` +
          `This portfolio only displays the corresponding HTML exports. ` +
          `Please open the HTML version of this activity.</p>`
        );
      }else if(lower.endsWith('.html') || lower.endsWith('.htm')){
        if(!file.download_url){
          showPreview(`<p class="small">HTML file cannot be accessed.</p>`);
          return;
        }
        const res = await fetch(file.download_url);
        const htmlText = await res.text();
        const iframe = document.createElement('iframe');
        iframe.srcdoc = htmlText;
        const wrapper = document.createElement('div');
        wrapper.appendChild(iframe);
        const bodyElem = document.getElementById('preview-body');
        bodyElem.innerHTML = '';
        bodyElem.appendChild(wrapper);
      }else{
        showPreview(
          `<p class="small">File <code>${file.name}</code> is not a markdown or HTML file, so it is not rendered here.</p>`
        );
      }
    }catch(e){
      showPreview(`<p class="small">Could not open file <code>${path}</code>: ${e.message}</p>`);
    }
  }

  async function loadFolderList(folderName, containerId, kind){
    try{
      const list = await fetchJson(`${apiBase}/${folderName}`);
      const ul = document.getElementById(containerId);
      ul.innerHTML = '';

      const sidebarMap = {
        'lecture': 'sidebar-lectures',
        'lab': 'sidebar-labs',
        'exercise': 'sidebar-exercises',
        'group': 'sidebar-groups'
      };
      const sidebarUl = document.getElementById(sidebarMap[kind] || '');

      if(sidebarUl){ sidebarUl.innerHTML = ''; }

      const htmlFiles = list
        .filter(item => item.type === 'file')
        .filter(item => /\.html?$/i.test(item.name));

      htmlFiles.forEach(item => {
        const cleanName = item.name.replace(/\.html?$/,'');
        let chipClass = 'chip';
        if(kind === 'lecture') chipClass += ' chip-lecture';
        else if(kind === 'lab') chipClass += ' chip-lab';
        else if(kind === 'exercise') chipClass += ' chip-ex';
        else if(kind === 'group') chipClass += ' chip-group';

        // Middle list
        const li = document.createElement('li');
        li.innerHTML = `
          <button type="button" class="link-button">${cleanName}</button>
          <span class="${chipClass}">${kind}</span>`;
        li.querySelector('button').onclick = () => openFile(`${folderName}/${item.name}`, cleanName);
        ul.appendChild(li);

        // Sidebar list
        if(sidebarUl){
          const sLi = document.createElement('li');
          sLi.innerHTML = `
            <button type="button" class="link-button" style="color:#e5e7eb;font-size:13px;">
              ${cleanName}
            </button>`;
          sLi.querySelector('button').onclick = () => openFile(`${folderName}/${item.name}`, cleanName);
          sidebarUl.appendChild(sLi);
        }

        // Search index (HTML only)
        searchIndex.push({ title: cleanName, path: `${folderName}/${item.name}`, kind });
      });

      if(!ul.innerHTML){
        ul.innerHTML = '<li class="small">No HTML files found in this folder.</li>';
      }
      if(sidebarUl && !sidebarUl.innerHTML){
        sidebarUl.innerHTML = '<li class="small" style="color:#9ca3af;">No HTML files</li>';
      }
    }catch(e){
      const ul = document.getElementById(containerId);
      ul.innerHTML = `<li class="small">Could not load <code>${folderName}</code>: ${e.message}</li>`;
      const sidebarMap = {
        'lecture': 'sidebar-lectures',
        'lab': 'sidebar-labs',
        'exercise': 'sidebar-exercises',
        'group': 'sidebar-groups'
      };
      const sidebarUl = document.getElementById(sidebarMap[kind] || '');
      if(sidebarUl){
        sidebarUl.innerHTML = '<li class="small" style="color:#9ca3af;">Error loading</li>';
      }
    }
  }

  function showPreview(html){
    const bodyElem = document.getElementById('preview-body');
    bodyElem.innerHTML = `<div id="preview">${html}</div>`;
  }

  // Simple markdown renderer (for README.md etc.)
  function renderMarkdown(md){
    md = md.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    md = md.replace(/```([\s\S]*?)```/g,(m,code)=>`<pre>${code}</pre>`);
    md = md.replace(/^### (.*)$/gim,'<h3>$1</h3>');
    md = md.replace(/^## (.*)$/gim,'<h2>$1</h2>');
    md = md.replace(/^# (.*)$/gim,'<h1>$1</h1>');
    md = md.replace(/\*\*(.*?)\*\*/gim,'<strong>$1</strong>');
    md = md.replace(/\*(.*?)\*/gim,'<em>$1</em>');
    md = md.replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" target="_blank">$1</a>');
    const paragraphs = md.split(/\n\s*\n/).map(p =>
      `<p class="small">${p.replace(/\n/g,'<br/>')}</p>`
    ).join('');
    return paragraphs;
  }

  async function loadBlog(){
    try{
      const list = await fetchJson(`${apiBase}/Blog_Post`);
      const blogList = document.getElementById('blog-list');
      blogList.innerHTML = '';
      const sidebarBlog = document.getElementById('sidebar-blog');
      sidebarBlog.innerHTML = '';

      const htmlFiles = list
        .filter(item => item.type === 'file')
        .filter(item => /\.html?$/i.test(item.name));

      htmlFiles.forEach(item => {
        const title = item.name.replace(/\.html?$/,'');
        const div = document.createElement('div');
        div.className = 'folder-card';
        div.innerHTML = `
          <div class="folder-title">
            <span>${title}</span>
            <span class="chip chip-blog">blog</span>
          </div>
          <div class="folder-path">${item.name}</div>
          <div class="small" style="margin-top:4px;">Click to show this blog HTML as the main page.</div>`;
        div.onclick = () => openFile(`Blog_Post/${item.name}`, title);
        blogList.appendChild(div);

        // sidebar
        const li = document.createElement('li');
        li.innerHTML = `
          <button type="button" class="link-button" style="color:#e5e7eb;font-size:13px;">
            ${title}
          </button>`;
        li.querySelector('button').onclick = () => openFile(`Blog_Post/${item.name}`, title);
        sidebarBlog.appendChild(li);

        searchIndex.push({ title, path: `Blog_Post/${item.name}`, kind: 'blog' });
      });

      if(!blogList.innerHTML){
        blogList.innerHTML = '<div class="small">No HTML blog posts found.</div>';
      }
      if(!sidebarBlog.innerHTML){
        sidebarBlog.innerHTML = '<li class="small" style="color:#9ca3af;">No blog posts</li>';
      }
    }catch(e){
      document.getElementById('blog-list').innerHTML =
        '<div class="small">No Blog_Post folder found or could not load it.</div>';
      const sidebarBlog = document.getElementById('sidebar-blog');
      sidebarBlog.innerHTML = '<li class="small" style="color:#9ca3af;">Error loading</li>';
    }
  }

  // Search – HTML only
  function handleSearch(query){
    const container = document.getElementById('search-results');
    query = query.trim().toLowerCase();
    if(!query){
      container.innerHTML = '';
      return;
    }
    const results = searchIndex
      .filter(item => item.title.toLowerCase().includes(query))
      .slice(0,8);
    if(!results.length){
      container.innerHTML = '<div class="sidebar-search-empty">No matches.</div>';
      return;
    }
    container.innerHTML = results.map(item => `
      <button class="sidebar-search-item" onclick="openFile('${item.path}','${item.title.replace(/'/g,"&#39;")}')">
        <span>${item.title}</span>
        <span class="sidebar-search-kind">${item.kind}</span>
      </button>
    `).join('');
  }

  // Top bar actions
  function toggleSidebar(){document.body.classList.toggle('sidebar-hidden');}
  function toggleToc(){document.body.classList.toggle('toc-hidden');}
  function downloadZip(){
    window.open(`https://github.com/${owner}/${repo}/archive/refs/heads/main.zip`,'_blank');
  }
  function toggleTheme(){document.body.classList.toggle('theme-dark');}
  function toggleFullscreen(){
    if(!document.fullscreenElement){
      document.documentElement.requestFullscreen?.();
    }else{
      document.exitFullscreen?.();
    }
  }

  // init
  loadRepo();
  loadBlog();
</script>
</body>
</html>
